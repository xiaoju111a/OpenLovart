# 立即修复指南

## 🚨 快速修复步骤

### 1. 重启开发服务器（必须！）
```bash
# 按 Ctrl+C 停止服务器
# 然后重新启动
npm run dev
```

### 2. 测试工具栏
访问测试页面：
```
http://localhost:3000/test-toolbar
```

**应该看到**:
- 一个蓝色测试图片
- 图片上方有完整的工具栏
- 工具栏包含所有按钮

### 3. 测试画布
访问画布页面：
```
http://localhost:3000/lovart/canvas
```

**操作步骤**:
1. 点击左侧 "+" 按钮
2. 选择"上传图片"
3. 上传一张图片
4. **点击图片**（应该出现蓝色边框）
5. **工具栏应该出现在图片上方**

## 🔍 如果工具栏还是不显示

### 检查 1: 打开浏览器控制台
按 F12 打开开发者工具，查看是否有错误

### 检查 2: 确认元素被选中
- 图片应该有**蓝色边框**
- 如果没有边框，说明没有选中
- 尝试再次点击图片

### 检查 3: 检查工具状态
- 确保不是"手型工具"模式
- 左侧工具栏应该选中"选择工具"（鼠标图标）

### 检查 4: 尝试缩放
- 工具栏可能在屏幕外
- 按住 Ctrl + 滚轮缩小画布
- 或者按 Ctrl + 0 重置缩放

## 📸 图像生成问题

### 临时禁用图像生成
如果图像生成一直失败，可以暂时禁用这个功能：

1. 点击工具栏的"流程"按钮（而不是"扩展元素"）
2. 这会创建一个图像生成器占位符
3. 你可以手动上传图片替代

### 检查 API Key
```bash
# 查看 .env.local 文件
cat .env.local | grep GEMINI
```

应该看到：
```
GEMINI_API_KEY=AIzaSy...
```

如果没有或为空，需要：
1. 访问 https://aistudio.google.com/app/apikey
2. 创建新的 API key
3. 添加到 `.env.local`
4. 重启服务器

## 🎯 最简单的测试

### 测试 1: 独立工具栏
```
http://localhost:3000/test-toolbar
```
- ✅ 如果这里能看到工具栏 → ContextToolbar 组件正常
- ❌ 如果这里也看不到 → 组件有问题

### 测试 2: 画布工具栏
```
http://localhost:3000/lovart/canvas
```
- ✅ 如果能看到工具栏 → 一切正常
- ❌ 如果看不到 → 集成有问题

## 🔧 强制刷新

如果修改没有生效：

1. **清除浏览器缓存**:
   - 按 Ctrl+Shift+Delete
   - 选择"缓存的图片和文件"
   - 点击"清除数据"

2. **硬刷新页面**:
   - 按 Ctrl+Shift+R（Windows/Linux）
   - 或 Cmd+Shift+R（Mac）

3. **删除 .next 文件夹**:
   ```bash
   # 停止服务器
   rm -rf .next
   # 重新启动
   npm run dev
   ```

## 📋 完整检查清单

按顺序检查：

1. [ ] 服务器已重启
2. [ ] 访问 `/test-toolbar` 能看到工具栏
3. [ ] 访问 `/lovart/canvas` 
4. [ ] 上传图片成功
5. [ ] 点击图片出现蓝色边框
6. [ ] 工具栏出现在图片上方
7. [ ] 工具栏包含所有按钮
8. [ ] 点击按钮有响应

## 🆘 紧急联系

如果以上都不行，提供以下信息：

1. **浏览器控制台截图**（F12 → Console 标签）
2. **`/test-toolbar` 页面截图**
3. **`/lovart/canvas` 页面截图**
4. **React DevTools 截图**（如果安装了）

## 💡 临时解决方案

如果工具栏一直不显示，可以使用键盘快捷键：

- **Delete** 或 **Backspace** - 删除选中元素
- **Ctrl+C** - 复制（如果实现了）
- **Ctrl+V** - 粘贴（如果实现了）

或者右键点击元素（如果实现了右键菜单）

## ✅ 成功标志

当一切正常时，你应该看到：

1. 图片上传后立即显示
2. 点击图片出现蓝色边框
3. **工具栏立即出现在图片上方**
4. 工具栏包含：
   - 📐 尺寸显示
   - 🎨 替换背景
   - 👕 Mockup
   - ✨ 编辑元素
   - ➡️ 流程（蓝色）
   - 🔮 扩展元素（紫蓝渐变）
   - 📋 复制
   - ⬇️ 下载
   - 🗑️ 删除

现在就试试吧！
